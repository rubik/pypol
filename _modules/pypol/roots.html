
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>pypol.roots &mdash; pypol v0.4 documentation</title>
    <link rel="stylesheet" href="../../_static/celery.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '0.4',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <link rel="top" title="pypol v0.4 documentation" href="../../index.html" />
    <link rel="up" title="pypol" href="../pypol.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../../index.html">pypol v0.4 documentation</a> &raquo;</li>
          <li><a href="../index.html" >Module code</a> &raquo;</li>
          <li><a href="../pypol.html" accesskey="U">pypol</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <h1>Source code for pypol.roots</h1><div class="highlight"><pre>
<span class="c">#!/usr/bin/env python2.6</span>
<span class="c"># -*- coding: utf-8 -*-</span>

<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">pypol - a Python library to manipulate polynomials and algebraic fractions.</span>

<span class="sd">This program is free software; you can redistribute it and/or modify</span>
<span class="sd">it under the terms of the GNU Lesser General Public License as published by</span>
<span class="sd">the Free Software Foundation; either version 3 of the License, or</span>
<span class="sd">(at your option) any later version.</span>

<span class="sd">This program is distributed in the hope that it will be useful,</span>
<span class="sd">but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="sd">MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="sd">GNU Lesser General Public License for more details.</span>

<span class="sd">You should have received a copy of the GNU Lesser General Public License</span>
<span class="sd">along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>

<span class="sd">Requirements:</span>
<span class="sd">- Python 2.6 (or 2.7)</span>

<span class="sd">This module implements some root-finding algorithms, like the Newton&#39;s methods, or the Durand-Kerner method</span>

<span class="sd">(C) Copyright 2010 Michele Lacchia</span>
<span class="sd">&#39;&#39;&#39;</span>

<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">division</span>

<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">cmath</span>
<span class="kn">import</span> <span class="nn">decimal</span>
<span class="kn">import</span> <span class="nn">operator</span>
<span class="kn">from</span> <span class="nn">pypol</span> <span class="kn">import</span> <span class="n">poly1d</span><span class="p">,</span> <span class="n">monomial</span><span class="p">,</span> <span class="n">Polynomial</span>
<span class="kn">from</span> <span class="nn">funcs</span> <span class="kn">import</span> <span class="n">polyder</span><span class="p">,</span> <span class="n">divided_diff</span>

<div class="viewcode-block" id="ruffini"><a class="viewcode-back" href="../../roots.html#pypol.roots.ruffini">[docs]</a><span class="k">def</span> <span class="nf">ruffini</span><span class="p">(</span><span class="n">poly</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Returns the real integer roots (if there are any) of the polynomial basing on the right-hand side. If the polynomial has not the right-hand side, returns an empty list.</span>

<span class="sd">    **Examples**</span>

<span class="sd">    ::</span>

<span class="sd">        &gt;&gt;&gt; p = poly1d([1, 5, 5, -5, -6])</span>
<span class="sd">        &gt;&gt;&gt; p</span>
<span class="sd">        + x^4 + 5x^3 + 5x^2 - 5x - 6</span>
<span class="sd">        &gt;&gt;&gt; ruffini(p)</span>
<span class="sd">        [-1, 1]</span>
<span class="sd">        &gt;&gt;&gt; p(-1), p(1)</span>
<span class="sd">        (0, 0)</span>

<span class="sd">    and we can go on::</span>

<span class="sd">        &gt;&gt;&gt; p2, p3 = p / (x - 1), p / (x + 1)</span>
<span class="sd">        &gt;&gt;&gt; p2, p3</span>
<span class="sd">        (+ x^3 + 6x^2 + 11x + 6, + x^3 + 4x^2 + x - 6)</span>
<span class="sd">        &gt;&gt;&gt; ruffini(p2), ruffini(p3)</span>
<span class="sd">        ([-1, -2, -3], [1])</span>
<span class="sd">        &gt;&gt;&gt; p2(-1), p2(-2), p2(-3)</span>
<span class="sd">        (0, 0, 0)</span>
<span class="sd">        &gt;&gt;&gt; p3(1)</span>
<span class="sd">        0</span>
<span class="sd">        &gt;&gt;&gt; p4, p5, p6 = p2 / (x - 1), p2 / (x - 2), p / (x - 3)</span>
<span class="sd">        &gt;&gt;&gt; p4, p5, p6</span>
<span class="sd">        (+ x^2 + 7x + 18, + x^2 + 8x + 27, + x^3 + 8x^2 + 29x + 82)</span>
<span class="sd">        &gt;&gt;&gt; ruffini(p4), ruffini(p5), ruffini(p6)</span>
<span class="sd">        ([], [], [])</span>

<span class="sd">    there are no more real roots, but if we try :func:`quadratic`::</span>

<span class="sd">        &gt;&gt;&gt; quadratic(p4), quadratic(p5)</span>
<span class="sd">        (((-3.5+2.3979157616563596j), (-3.5-2.3979157616563596j)), ((-4+3.3166247903553998j), (-4-3.3166247903553998j)))</span>

<span class="sd">    .. versionadded:: 0.3</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="k">def</span> <span class="nf">_divs</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="n">d</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">n</span> <span class="o">//</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span> <span class="o">+</span> <span class="p">[</span><span class="n">n</span><span class="p">]</span>
        <span class="k">return</span> <span class="nb">map</span><span class="p">(</span><span class="n">operator</span><span class="o">.</span><span class="n">neg</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span> <span class="o">+</span> <span class="n">d</span>

    <span class="n">p</span> <span class="o">=</span> <span class="n">poly</span><span class="o">.</span><span class="n">right_hand_side</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">p</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[]</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">_divs</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">poly</span><span class="p">(</span><span class="n">x</span><span class="p">)]</span>
</div>
<div class="viewcode-block" id="quadratic"><a class="viewcode-back" href="../../roots.html#pypol.roots.quadratic">[docs]</a><span class="k">def</span> <span class="nf">quadratic</span><span class="p">(</span><span class="n">poly</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Finds the two roots of the polynomial *poly* solving the quadratic equation: :math:`ax^2 + bx + c = 0`</span>

<span class="sd">    with the formula:</span>
<span class="sd">        :math:`\\frac{-b\pm \sqrt{b^2 - 4ac}}{2a}`</span>

<span class="sd">    :raises: :exc:`AssertionError` if the polynomial&#39;s degree is not 2.</span>
<span class="sd">    :rtype: 2 numbers (integer, float or complex) in a tuple</span>

<span class="sd">    **Examples**</span>

<span class="sd">    ::</span>

<span class="sd">        &gt;&gt;&gt; p = poly1d([1, 0, -4])</span>
<span class="sd">        &gt;&gt;&gt; p</span>
<span class="sd">        + x^2 - 4</span>
<span class="sd">        &gt;&gt;&gt; quadratic(p)</span>
<span class="sd">        (2.0, -2.0)</span>
<span class="sd">        &gt;&gt;&gt; p(2)</span>
<span class="sd">        0</span>
<span class="sd">        &gt;&gt;&gt; p(-2)</span>
<span class="sd">        0</span>
<span class="sd">        &gt;&gt;&gt; p = poly1d([2, 3, 1])</span>
<span class="sd">        &gt;&gt;&gt; p</span>
<span class="sd">        + 2x^2 + 3x + 1</span>
<span class="sd">        &gt;&gt;&gt; quadratic(p)</span>
<span class="sd">        (-0.5, -1.0)</span>
<span class="sd">        &gt;&gt;&gt; p(-0.5)</span>
<span class="sd">        0.0</span>
<span class="sd">        &gt;&gt;&gt; p(-1.0)</span>
<span class="sd">        0.0</span>

<span class="sd">    this functions can return complex numbers too::</span>

<span class="sd">        &gt;&gt;&gt; p = poly1d([-4, 5, -3])</span>
<span class="sd">        &gt;&gt;&gt; p</span>
<span class="sd">        - 4x^2 + 5x - 3</span>
<span class="sd">        &gt;&gt;&gt; quadratic(p)</span>
<span class="sd">        ((0.625-0.59947894041408989j), (0.625+0.59947894041408989j))</span>

<span class="sd">    but the precision is lower::</span>

<span class="sd">        &gt;&gt;&gt; p = poly1d([-4, 5, -3])</span>
<span class="sd">        &gt;&gt;&gt; p</span>
<span class="sd">        - 4x^2 + 5x - 3</span>
<span class="sd">        &gt;&gt;&gt; quadratic(p)</span>
<span class="sd">        ((0.625-0.59947894041408989j), (0.625+0.59947894041408989j))</span>
<span class="sd">        &gt;&gt;&gt; r1 = (0.625-0.59947894041408989j)</span>
<span class="sd">        &gt;&gt;&gt; p(r1)</span>
<span class="sd">        (-4.4408920985006262e-16+0j)</span>
<span class="sd">        &gt;&gt;&gt; r2 = (0.625+0.59947894041408989j)</span>
<span class="sd">        &gt;&gt;&gt; p(r2)</span>
<span class="sd">        (-4.4408920985006262e-16+0j)</span>

<span class="sd">    .. versionadded:: 0.3</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="n">poly</span> <span class="o">=</span> <span class="n">poly</span><span class="o">.</span><span class="n">filter</span><span class="p">()</span>
    <span class="k">assert</span> <span class="n">poly</span><span class="o">.</span><span class="n">degree</span> <span class="o">==</span> <span class="mi">2</span><span class="p">,</span> <span class="s">&#39;The polynomial</span><span class="se">\&#39;</span><span class="s">s degree must be 2&#39;</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">poly</span><span class="o">.</span><span class="n">coefficients</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
        <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">poly</span><span class="o">.</span><span class="n">coefficients</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">poly</span><span class="p">,</span> <span class="s">&#39;get&#39;</span><span class="p">),</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">b</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">-</span> <span class="mi">4</span><span class="o">*</span><span class="n">a</span><span class="o">*</span><span class="n">c</span>
    <span class="k">if</span> <span class="n">r</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">r</span> <span class="o">=</span> <span class="nb">complex</span><span class="p">(</span><span class="n">imag</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="n">r</span><span class="p">)</span> <span class="o">**</span> <span class="mf">0.5</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">r</span> <span class="o">**</span> <span class="mf">0.5</span>
    <span class="k">return</span> <span class="p">((</span><span class="o">-</span><span class="n">b</span> <span class="o">+</span> <span class="n">r</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="n">b</span> <span class="o">-</span> <span class="n">r</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="cubic"><a class="viewcode-back" href="../../roots.html#pypol.roots.cubic">[docs]</a><span class="k">def</span> <span class="nf">cubic</span><span class="p">(</span><span class="n">poly</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Finds the three roots of the polynomial *poly* solving the equation: :math:`ax^3 + bx^2 + cx + d = 0`.</span>

<span class="sd">    :raises: :exc:`AssertionError` if the polynomial&#39;s degree is not 3.</span>
<span class="sd">    :rtype: 3 numbers (integer, float or complex) in a tuple</span>

<span class="sd">    **Examples**</span>

<span class="sd">    ::</span>

<span class="sd">        &gt;&gt;&gt; k = poly1d([3, -2, 45, -1])</span>
<span class="sd">        &gt;&gt;&gt; k</span>
<span class="sd">        + 3x^3 - 2x^2 + 45x - 1</span>
<span class="sd">        &gt;&gt;&gt; cubic(k)</span>
<span class="sd">        (0.022243478406449024, (0.3222115941301088+3.8576995055778323j), (0.3222115941301088-3.8576995055778323j))</span>
<span class="sd">        &gt;&gt;&gt; k = poly1d([-9, 12, -2, -34])</span>
<span class="sd">        &gt;&gt;&gt; k</span>
<span class="sd">        - 9x^3 + 12x^2 - 2x - 34</span>
<span class="sd">        &gt;&gt;&gt; cubic(k)</span>
<span class="sd">        (-1.182116114781928, (1.2577247240576306+1.2703952413531459j), (1.2577247240576306-1.2703952413531459j))</span>
<span class="sd">        &gt;&gt;&gt; k = poly1d([1, 1, 1, 1])</span>
<span class="sd">        &gt;&gt;&gt; cubic(k)</span>
<span class="sd">        (-1.0, (5.551115123125783e-17+0.9999999999999999j), (5.551115123125783e-17-0.9999999999999999j))</span>
<span class="sd">        &gt;&gt;&gt; k(-1.)</span>
<span class="sd">        0.0</span>
<span class="sd">        &gt;&gt;&gt; k = poly1d([-1, 1, 0, 1])</span>
<span class="sd">        &gt;&gt;&gt; cubic(k)</span>
<span class="sd">        (1.4655712318767669, (-0.23278561593838348+0.7925519925154489j), (-0.23278561593838348-0.7925519925154489j))</span>
<span class="sd">        &gt;&gt;&gt; k(cubic(k)[0])</span>
<span class="sd">        3.9968028886505635e-15</span>

<span class="sd">    **References**</span>

<span class="sd">    `Wikipedia &lt;http://en.wikipedia.org/wiki/Cubic_function&gt;`_ | `MathWorld &lt;http://mathworld.wolfram.com/CubicFormula.html&gt;`_ | `1728 &lt;http://www.1728.com/cubic.htm&gt;`_</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="n">poly</span> <span class="o">=</span> <span class="n">poly</span><span class="o">.</span><span class="n">filter</span><span class="p">()</span>
    <span class="k">assert</span> <span class="n">poly</span><span class="o">.</span><span class="n">degree</span> <span class="o">==</span> <span class="mi">3</span><span class="p">,</span> <span class="s">&#39;The polynomial</span><span class="se">\&#39;</span><span class="s">s degree must be 3&#39;</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">poly</span><span class="o">.</span><span class="n">coefficients</span><span class="p">)</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
        <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span> <span class="o">=</span> <span class="n">poly</span><span class="o">.</span><span class="n">coefficients</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">poly</span><span class="p">,</span> <span class="s">&#39;get&#39;</span><span class="p">),</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>

    <span class="k">if</span> <span class="n">a</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">poly</span> <span class="o">=</span> <span class="n">poly1d</span><span class="p">([</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">quadratic</span><span class="p">(</span><span class="n">poly</span><span class="p">)</span>
    <span class="n">f</span> <span class="o">=</span> <span class="p">((</span><span class="mi">3</span><span class="o">*</span><span class="n">c</span> <span class="o">/</span> <span class="n">a</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">b</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="n">a</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span> <span class="o">/</span> <span class="mi">3</span>
    <span class="n">g</span> <span class="o">=</span> <span class="p">((</span><span class="mi">2</span><span class="o">*</span><span class="n">b</span><span class="o">**</span><span class="mi">3</span> <span class="o">/</span> <span class="n">a</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="mi">9</span><span class="o">*</span><span class="n">b</span><span class="o">*</span><span class="n">c</span> <span class="o">/</span> <span class="n">a</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="mi">27</span><span class="o">*</span><span class="n">d</span> <span class="o">/</span> <span class="n">a</span><span class="p">))</span> <span class="o">/</span> <span class="mi">27</span>
    <span class="n">h</span> <span class="o">=</span> <span class="p">(</span><span class="n">g</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">f</span><span class="o">**</span><span class="mi">3</span> <span class="o">/</span> <span class="mi">27</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">h</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span> <span class="c"># only 1 root is real</span>
        <span class="n">b_3a</span> <span class="o">=</span> <span class="o">-</span> <span class="p">(</span><span class="n">b</span> <span class="o">/</span> <span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">a</span><span class="p">))</span>
        <span class="n">r</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">g</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">r</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">s</span> <span class="o">=</span> <span class="o">-</span><span class="p">((</span><span class="o">-</span><span class="n">r</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">s</span> <span class="o">=</span> <span class="n">r</span> <span class="o">**</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span>
        <span class="n">t</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">g</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">t</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">u</span> <span class="o">=</span> <span class="o">-</span> <span class="p">((</span><span class="o">-</span><span class="n">t</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">u</span> <span class="o">=</span> <span class="n">t</span> <span class="o">**</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span>

        <span class="n">x1</span> <span class="o">=</span> <span class="p">(</span><span class="n">s</span> <span class="o">+</span> <span class="n">u</span><span class="p">)</span> <span class="o">+</span> <span class="n">b_3a</span>
        <span class="n">x2</span> <span class="o">=</span> <span class="nb">complex</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">s</span> <span class="o">+</span> <span class="n">u</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">b_3a</span><span class="p">,</span> <span class="p">(</span><span class="n">s</span> <span class="o">-</span> <span class="n">u</span><span class="p">)</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">x3</span> <span class="o">=</span> <span class="nb">complex</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">s</span> <span class="o">+</span> <span class="n">u</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">b_3a</span><span class="p">,</span> <span class="o">-</span><span class="p">(</span><span class="n">s</span> <span class="o">-</span> <span class="n">u</span><span class="p">)</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">poly</span><span class="p">(</span><span class="n">x1</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">poly</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">x1</span><span class="p">)):</span>
            <span class="n">x1</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">x1</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">x3</span>

    <span class="k">if</span> <span class="n">f</span> <span class="o">==</span> <span class="n">g</span> <span class="o">==</span> <span class="n">h</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="c"># all 3 roots are real and equal</span>
        <span class="n">d_a</span> <span class="o">=</span> <span class="n">d</span> <span class="o">/</span> <span class="n">a</span>
        <span class="k">if</span> <span class="n">d_a</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">x1</span> <span class="o">=</span> <span class="n">x2</span> <span class="o">=</span> <span class="n">x3</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">d_a</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">x1</span> <span class="o">=</span> <span class="n">x2</span> <span class="o">=</span> <span class="n">x3</span> <span class="o">=</span> <span class="o">-</span><span class="p">((</span><span class="n">d</span> <span class="o">/</span> <span class="n">a</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">))</span>

        <span class="n">x1</span> <span class="o">=</span> <span class="n">x1</span><span class="o">*</span><span class="mf">1e14</span><span class="p">;</span> <span class="n">x1</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">x1</span><span class="p">);</span> <span class="n">x1</span> <span class="o">=</span> <span class="p">(</span><span class="n">x1</span><span class="o">/</span><span class="mf">1e14</span><span class="p">)</span>
        <span class="n">x2</span> <span class="o">=</span> <span class="n">x2</span><span class="o">*</span><span class="mf">1e14</span><span class="p">;</span> <span class="n">x2</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">x2</span><span class="p">);</span> <span class="n">x2</span> <span class="o">=</span> <span class="p">(</span><span class="n">x2</span><span class="o">/</span><span class="mf">1e14</span><span class="p">)</span>
        <span class="n">x3</span> <span class="o">=</span> <span class="n">x3</span><span class="o">*</span><span class="mf">1e14</span><span class="p">;</span> <span class="n">x3</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">x3</span><span class="p">);</span> <span class="n">x3</span> <span class="o">=</span> <span class="p">(</span><span class="n">x3</span><span class="o">/</span><span class="mf">1e14</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">x3</span>

    <span class="k">if</span> <span class="n">h</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span> <span class="c"># all 3 roots are real</span>
        <span class="n">i</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">g</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="mi">4</span><span class="p">)</span> <span class="o">-</span> <span class="n">h</span><span class="p">)</span>
        <span class="n">j_</span> <span class="o">=</span> <span class="n">i</span> <span class="o">**</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">3</span><span class="p">)</span>
        <span class="n">k</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">acos</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">g</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="p">)))</span>
        <span class="n">l</span> <span class="o">=</span> <span class="o">-</span><span class="n">j_</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">k</span> <span class="o">/</span> <span class="mi">3</span><span class="p">)</span>
        <span class="n">n</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">k</span> <span class="o">/</span> <span class="mi">3</span><span class="p">)</span>
        <span class="n">p</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">b</span> <span class="o">/</span> <span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">a</span><span class="p">))</span>
        <span class="n">x1</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">j_</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">k</span> <span class="o">/</span> <span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">p</span>
        <span class="n">x2</span> <span class="o">=</span> <span class="n">l</span> <span class="o">*</span> <span class="p">(</span><span class="n">m</span> <span class="o">+</span> <span class="n">n</span><span class="p">)</span> <span class="o">+</span> <span class="n">p</span>
        <span class="n">x3</span> <span class="o">=</span> <span class="n">l</span> <span class="o">*</span> <span class="p">(</span><span class="n">m</span> <span class="o">-</span> <span class="n">n</span><span class="p">)</span> <span class="o">+</span> <span class="n">p</span>

        <span class="n">x1</span> <span class="o">=</span> <span class="n">x1</span><span class="o">*</span><span class="mf">1e14</span><span class="p">;</span> <span class="n">x1</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">x1</span><span class="p">);</span> <span class="n">x1</span> <span class="o">=</span> <span class="p">(</span><span class="n">x1</span><span class="o">/</span><span class="mf">1e14</span><span class="p">)</span>
        <span class="n">x2</span> <span class="o">=</span> <span class="n">x2</span><span class="o">*</span><span class="mf">1e14</span><span class="p">;</span> <span class="n">x2</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">x2</span><span class="p">);</span> <span class="n">x2</span> <span class="o">=</span> <span class="p">(</span><span class="n">x2</span><span class="o">/</span><span class="mf">1e14</span><span class="p">)</span>
        <span class="n">x3</span> <span class="o">=</span> <span class="n">x3</span><span class="o">*</span><span class="mf">1e14</span><span class="p">;</span> <span class="n">x3</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">x3</span><span class="p">);</span> <span class="n">x3</span> <span class="o">=</span> <span class="p">(</span><span class="n">x3</span><span class="o">/</span><span class="mf">1e14</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">poly</span><span class="p">(</span><span class="n">x1</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">poly</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">x1</span><span class="p">)):</span>
            <span class="n">x1</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">x1</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">poly</span><span class="p">(</span><span class="n">x2</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">poly</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">x2</span><span class="p">)):</span>
            <span class="n">x2</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">x2</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">poly</span><span class="p">(</span><span class="n">x3</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">poly</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">x3</span><span class="p">)):</span>
            <span class="n">x3</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">x3</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">x3</span>
</div>
<div class="viewcode-block" id="quartic"><a class="viewcode-back" href="../../roots.html#pypol.roots.quartic">[docs]</a><span class="k">def</span> <span class="nf">quartic</span><span class="p">(</span><span class="n">poly</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Finds all four roots of a fourth-degree polynomial *poly*::</span>

<span class="sd">    :raises: :exc:`AssertionError` if the polynomial&#39;s degree is not 4</span>
<span class="sd">    :rtype: 4 numbers (integer, float or complex) in a tuple</span>

<span class="sd">    **Examples**</span>

<span class="sd">    When all the roots are real::</span>

<span class="sd">        &gt;&gt;&gt; from pypol.roots import *</span>
<span class="sd">        &gt;&gt;&gt; from pypol.funcs import from_roots</span>
<span class="sd">        &gt;&gt;&gt; p = from_roots([1, -4, 2, 3])</span>
<span class="sd">        &gt;&gt;&gt; p</span>
<span class="sd">        + x^4 - 2x^3 - 13x^2 + 38x - 24</span>
<span class="sd">        &gt;&gt;&gt; quartic(p)</span>
<span class="sd">        [1, 3.0, -4.0, 2.0]</span>
<span class="sd">        &gt;&gt;&gt; map(p, quartic(p))</span>
<span class="sd">        [0, 0.0, 0.0, 0.0]</span>
<span class="sd">        &gt;&gt;&gt; p = from_roots([-1, 42, 2, -19239])</span>
<span class="sd">        &gt;&gt;&gt; p</span>
<span class="sd">        + x^4 + 19196x^3 - 827237x^2 + 769644x + 1616076</span>
<span class="sd">        &gt;&gt;&gt; quartic(p)</span>
<span class="sd">        [-1, 42.0, -19239.0, 2.0]</span>
<span class="sd">        &gt;&gt;&gt; map(p, quartic(p))</span>
<span class="sd">        [0, 0.0, 3.0, 0.0]</span>

<span class="sd">    Otherwise, if there are complex roots it loses precision and this is due to floating point numbers::</span>

<span class="sd">        &gt;&gt;&gt; from pypol import *</span>
<span class="sd">        &gt;&gt;&gt; from pypol.roots import *</span>
<span class="sd">        &gt;&gt;&gt; </span>
<span class="sd">        &gt;&gt;&gt; p = poly1d([1, -3, 4, 2, 1])</span>
<span class="sd">        &gt;&gt;&gt; p</span>
<span class="sd">        + x^4 - 3x^3 + 4x^2 + 2x + 1</span>
<span class="sd">        &gt;&gt;&gt; quartic(p)</span>
<span class="sd">        ((1.7399843312651568+1.5686034407060976j), (1.7399843312651568-1.5686034407060976j), (-0.23998433126515695+0.35301727734776445j), (-0.23998433126515695-0.35301727734776445j))</span>
<span class="sd">        &gt;&gt;&gt; map(p, quartic(p))</span>
<span class="sd">        [(8.8817841970012523e-16+8.4376949871511897e-15j), (8.8817841970012523e-16-8.4376949871511897e-15j), (8.3266726846886741e-15-2.7755575615628914e-15j), (8.3266726846886741e-15+2.7755575615628914e-15j)]</span>
<span class="sd">        &gt;&gt;&gt; p = poly1d([4, -3, 4, 2, 1])</span>
<span class="sd">        &gt;&gt;&gt; p</span>
<span class="sd">        + 4x^4 - 3x^3 + 4x^2 + 2x + 1</span>
<span class="sd">        &gt;&gt;&gt; quartic(p)</span>
<span class="sd">        ((0.62277368382725595+1.0277469284099872j), (0.62277368382725595-1.0277469284099872j), (-0.24777368382725601+0.33425306402324328j), (-0.24777368382725601-0.33425306402324328j))</span>
<span class="sd">        &gt;&gt;&gt; map(p, quartic(p))</span>
<span class="sd">        [(-2.5313084961453569e-14+3.730349362740526e-14j), (-2.5313084961453569e-14-3.730349362740526e-14j), (1.354472090042691e-14-1.2101430968414206e-14j), (1.354472090042691e-14+1.2101430968414206e-14j)]</span>

<span class="sd">    **References**</span>

<span class="sd">    `MathWorld &lt;http://mathworld.wolfram.com/QuarticEquation.html&gt;`_</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="k">assert</span> <span class="n">poly</span><span class="o">.</span><span class="n">degree</span> <span class="o">==</span> <span class="mi">4</span><span class="p">,</span> <span class="s">&#39;The polynomial</span><span class="se">\&#39;</span><span class="s">s degree must be 4&#39;</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">poly</span><span class="o">.</span><span class="n">coefficients</span><span class="p">)</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>
        <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">e</span> <span class="o">=</span> <span class="n">poly</span><span class="o">.</span><span class="n">coefficients</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">e</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">poly</span><span class="p">,</span> <span class="s">&#39;get&#39;</span><span class="p">),</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>

    <span class="n">poly</span> <span class="o">=</span> <span class="n">poly1d</span><span class="p">([</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">e</span><span class="p">])</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">poly</span><span class="p">(</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">roots</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">roots</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">cubic</span><span class="p">(</span><span class="n">poly</span> <span class="o">/</span> <span class="s">&#39;x - 1&#39;</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">roots</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">poly</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">roots</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">roots</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">cubic</span><span class="p">(</span><span class="n">poly</span> <span class="o">/</span> <span class="s">&#39;x + 1&#39;</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">roots</span>
    <span class="c">#if b == d == 0: # biquadratic ## DECOMMENT THIS?</span>
    <span class="c">#    l = poly.letters[0]</span>
    <span class="c">#    for m in poly.monomials:</span>
    <span class="c">#        m[1][l] = m[1][l] / 2</span>
    <span class="c">#    print poly</span>
    <span class="c">#    poly_ = poly(x=monomial(z=1))</span>
    <span class="c">#    return quadratic(poly_)</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">quadratic</span><span class="p">(</span><span class="n">Polynomial</span><span class="p">(</span><span class="n">poly</span><span class="p">[</span><span class="mi">2</span><span class="p">:]))</span>
    <span class="k">if</span> <span class="n">a</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">cubic</span><span class="p">(</span><span class="n">Polynomial</span><span class="p">(</span><span class="n">poly</span><span class="p">[</span><span class="mi">1</span><span class="p">:]))</span>

    <span class="n">poly</span> <span class="o">=</span> <span class="n">poly</span><span class="o">.</span><span class="n">div_all</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="nb">int</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">poly</span><span class="o">.</span><span class="n">coefficients</span><span class="p">)</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>
        <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">e</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="n">poly</span><span class="o">.</span><span class="n">coefficients</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">e</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="nb">map</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">poly</span><span class="p">,</span> <span class="s">&#39;get&#39;</span><span class="p">),</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]))</span>

    <span class="n">f</span> <span class="o">=</span> <span class="n">c</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">b</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="mi">8</span>
    <span class="n">g</span> <span class="o">=</span> <span class="n">d</span> <span class="o">+</span> <span class="n">b</span><span class="o">**</span><span class="mi">3</span> <span class="o">/</span> <span class="mi">8</span> <span class="o">-</span> <span class="n">b</span><span class="o">*</span><span class="n">c</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="n">h</span> <span class="o">=</span> <span class="n">e</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">b</span><span class="o">**</span><span class="mi">4</span> <span class="o">/</span> <span class="mi">256</span> <span class="o">+</span> <span class="n">b</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">c</span> <span class="o">/</span> <span class="mi">16</span> <span class="o">-</span> <span class="n">b</span><span class="o">*</span><span class="n">d</span> <span class="o">/</span> <span class="mi">4</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">monomial</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">eq</span> <span class="o">=</span> <span class="n">y</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="p">(</span><span class="n">f</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">y</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">((</span><span class="n">f</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">4</span><span class="o">*</span><span class="n">h</span><span class="p">)</span><span class="o">/</span><span class="mi">16</span><span class="p">)</span><span class="o">*</span><span class="n">y</span> <span class="o">-</span> <span class="n">g</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="mi">64</span>
    <span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y3</span> <span class="o">=</span> <span class="n">cubic</span><span class="p">(</span><span class="n">eq</span><span class="p">)</span>
    <span class="n">roots</span> <span class="o">=</span> <span class="p">[</span><span class="n">cmath</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="p">(</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y3</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="nb">complex</span><span class="p">)]</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">roots</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">p</span><span class="p">,</span> <span class="n">q</span> <span class="o">=</span> <span class="n">roots</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">p</span><span class="p">,</span> <span class="n">q</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">,</span> <span class="p">[</span><span class="n">r</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="p">(</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y3</span><span class="p">)</span> <span class="k">if</span> <span class="n">r</span><span class="p">][:</span><span class="mi">2</span><span class="p">])</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="n">p</span><span class="p">,</span> <span class="n">q</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="n">cmath</span><span class="o">.</span><span class="n">sqrt</span><span class="p">,</span> <span class="p">[</span><span class="n">r</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="p">(</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y3</span><span class="p">)</span> <span class="k">if</span> <span class="n">r</span><span class="p">][:</span><span class="mi">2</span><span class="p">])</span>
    <span class="n">r</span> <span class="o">=</span> <span class="o">-</span><span class="n">g</span> <span class="o">/</span> <span class="p">(</span><span class="mi">8</span><span class="o">*</span><span class="n">p</span><span class="o">*</span><span class="n">q</span><span class="p">)</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">b</span> <span class="o">/</span> <span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">a</span><span class="p">)</span>
    <span class="n">x1</span> <span class="o">=</span> <span class="n">p</span> <span class="o">+</span> <span class="n">q</span> <span class="o">+</span> <span class="n">r</span> <span class="o">-</span> <span class="n">s</span>
    <span class="n">x2</span> <span class="o">=</span> <span class="n">p</span> <span class="o">-</span> <span class="n">q</span> <span class="o">-</span> <span class="n">r</span> <span class="o">-</span> <span class="n">s</span>
    <span class="n">x3</span> <span class="o">=</span> <span class="o">-</span> <span class="n">p</span> <span class="o">+</span> <span class="n">q</span> <span class="o">-</span> <span class="n">r</span> <span class="o">-</span> <span class="n">s</span>
    <span class="n">x4</span> <span class="o">=</span> <span class="o">-</span> <span class="n">p</span> <span class="o">-</span> <span class="n">q</span> <span class="o">+</span> <span class="n">r</span> <span class="o">-</span> <span class="n">s</span>
    <span class="k">return</span> <span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">x3</span><span class="p">,</span> <span class="n">x4</span>
</div>
<div class="viewcode-block" id="newton"><a class="viewcode-back" href="../../roots.html#pypol.roots.newton">[docs]</a><span class="k">def</span> <span class="nf">newton</span><span class="p">(</span><span class="n">poly</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">epsilon</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="s">&#39;-inf&#39;</span><span class="p">)):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Finds one root of the polynomial *poly*, with this iteration formula:</span>
<span class="sd">        :math:`x_{n + 1} = x_n - \\frac{f(x_n)}{f&#39;(x_n)}`</span>

<span class="sd">    :param start: the start value for evaluate ``poly(x)``.</span>
<span class="sd">    :param epsilon: the precision of the calculus (default to ``float(&#39;-inf&#39;)``).</span>
<span class="sd">    :type start: integer, float or complex</span>
<span class="sd">    :type epsilon: integer or float</span>
<span class="sd">    :rtype: integer of float</span>

<span class="sd">    **Examples**</span>

<span class="sd">    ::</span>

<span class="sd">        &gt;&gt;&gt; k = poly1d([2, 5, 3])</span>
<span class="sd">        &gt;&gt;&gt; k</span>
<span class="sd">        + 2x^2 + 5x + 3</span>

<span class="sd">    the roots of this polynomial are ``-1`` and ``-1.5``.</span>
<span class="sd">    We start with 10::</span>

<span class="sd">        &gt;&gt;&gt; newton(k, 10)</span>
<span class="sd">        -1.0000000000000002</span>

<span class="sd">    so we try ``-1``::</span>

<span class="sd">        &gt;&gt;&gt; newton(k, -1)</span>
<span class="sd">        -1</span>
<span class="sd">        &gt;&gt;&gt; k(-1)</span>
<span class="sd">        0</span>

<span class="sd">    We have one root! We continue::</span>

<span class="sd">        &gt;&gt;&gt; newton(k, -2)</span>
<span class="sd">        -1.5</span>
<span class="sd">        &gt;&gt;&gt; k(-1.5)</span>
<span class="sd">        0.0</span>

<span class="sd">    This function can find complex roots too (if *start* is a complex number)::</span>

<span class="sd">        &gt;&gt;&gt; k = poly1d([1, -3, 6])</span>
<span class="sd">        &gt;&gt;&gt; k</span>
<span class="sd">        + x^2 - 3x + 6</span>
<span class="sd">        &gt;&gt;&gt; roots.quadratic(k)</span>
<span class="sd">        ((1.5+1.9364916731037085j), (1.5-1.9364916731037085j))</span>
<span class="sd">        &gt;&gt;&gt; roots.newton(k, complex(100, 1))</span>
<span class="sd">        (1.5+1.9364916731037085j)</span>
<span class="sd">        &gt;&gt;&gt; roots.newton(k, complex(100, -1))</span>
<span class="sd">        (1.5-1.9364916731037085j)</span>

<span class="sd">    **References**</span>

<span class="sd">    `Wikipedia &lt;http://en.wikipedia.org/wiki/Halley&#39;s_method&gt;`_ |</span>
<span class="sd">    `MathWorld &lt;http://mathworld.wolfram.com/HalleysMethod.html&gt;`_</span>

<span class="sd">    .. versionadded:: 0.3</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="n">poly_d</span> <span class="o">=</span> <span class="n">polyder</span><span class="p">(</span><span class="n">poly</span><span class="p">)</span>

    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
        <span class="n">p_s</span> <span class="o">=</span> <span class="n">poly</span><span class="p">(</span><span class="n">start</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">p_s</span><span class="p">:</span>
            <span class="k">break</span>
        <span class="n">x_n</span> <span class="o">=</span> <span class="n">start</span> <span class="o">-</span> <span class="n">p_s</span> <span class="o">/</span> <span class="n">poly_d</span><span class="p">(</span><span class="n">start</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">start</span> <span class="o">==</span> <span class="n">x_n</span> <span class="ow">or</span> <span class="nb">abs</span><span class="p">(</span><span class="n">start</span> <span class="o">-</span> <span class="n">x_n</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">epsilon</span><span class="p">:</span>
            <span class="k">break</span>
        <span class="n">start</span> <span class="o">=</span> <span class="n">x_n</span>

    <span class="k">return</span> <span class="n">start</span>
</div>
<div class="viewcode-block" id="halley"><a class="viewcode-back" href="../../roots.html#pypol.roots.halley">[docs]</a><span class="k">def</span> <span class="nf">halley</span><span class="p">(</span><span class="n">poly</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">epsilon</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="s">&#39;-inf&#39;</span><span class="p">)):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Finds one root of the polynomial *poly* using the Halley&#39;s method, with this iteration formula:</span>
<span class="sd">        :math:`x_{n + 1} = x_n - \\frac{2f(x_n)f&#39;(x_n)}{2[f&#39;(x_n)]^2 - f(x_n)f&#39;&#39;(x_n)}`</span>

<span class="sd">    :param start: the start value to evaluate ``poly(x)``</span>
<span class="sd">    :param epsilon: the precision, default to ``float(&#39;-inf&#39;)``</span>
<span class="sd">    :type start: integer, float or complex</span>
<span class="sd">    :type epsilon: integer or float</span>
<span class="sd">    :rtype: integer or float</span>

<span class="sd">    **Examples**</span>

<span class="sd">    We want to find the roots of the polynomial: ``x^3 - 4x^2 - x - 4``::</span>

<span class="sd">        &gt;&gt;&gt; p = (x + 1) * (x - 1) * (x + 4) ## its roots are: -1, 1, -4</span>
<span class="sd">        &gt;&gt;&gt; p</span>
<span class="sd">        + x^3 + 4x^2 - x - 4</span>

<span class="sd">    starting from an high number::</span>

<span class="sd">        &gt;&gt;&gt; halley(p, 90)</span>
<span class="sd">        1.0</span>
<span class="sd">        &gt;&gt;&gt; p(1.)</span>
<span class="sd">        0.0</span>

<span class="sd">    then we get lower::</span>

<span class="sd">        &gt;&gt;&gt; halley(p, -1)</span>
<span class="sd">        -1.0</span>
<span class="sd">        &gt;&gt;&gt; p(-1.)</span>
<span class="sd">        0.0</span>

<span class="sd">    and lower::</span>

<span class="sd">        &gt;&gt;&gt; halley(p, -90)</span>
<span class="sd">        -4.0</span>
<span class="sd">        &gt;&gt;&gt; p(-4.)</span>
<span class="sd">        0.0</span>

<span class="sd">    so we can say that the roots are: ``1``, ``-1``, and ``-4``.</span>

<span class="sd">    **References**</span>

<span class="sd">    `Wikipedia &lt;http://en.wikipedia.org/wiki/Halley&#39;s_method&gt;`_ |</span>
<span class="sd">    `MathWorld &lt;http://mathworld.wolfram.com/HalleysMethod.html&gt;`_</span>

<span class="sd">    .. versionadded:: 0.4</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="n">p_d</span><span class="p">,</span> <span class="n">p_d_</span> <span class="o">=</span> <span class="n">polyder</span><span class="p">(</span><span class="n">poly</span><span class="p">),</span> <span class="n">polyder</span><span class="p">(</span><span class="n">poly</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
        <span class="n">x_n</span> <span class="o">=</span> <span class="n">start</span> <span class="o">-</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">poly</span><span class="p">(</span><span class="n">start</span><span class="p">)</span> <span class="o">*</span> <span class="n">p_d</span><span class="p">(</span><span class="n">start</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">p_d</span><span class="p">(</span><span class="n">start</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">poly</span><span class="p">(</span><span class="n">start</span><span class="p">)</span> <span class="o">*</span> <span class="n">p_d_</span><span class="p">(</span><span class="n">start</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">x_n</span> <span class="o">==</span> <span class="n">start</span> <span class="ow">or</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x_n</span> <span class="o">-</span> <span class="n">start</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">epsilon</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">x_n</span>
        <span class="n">start</span> <span class="o">=</span> <span class="n">x_n</span>
</div>
<div class="viewcode-block" id="householder"><a class="viewcode-back" href="../../roots.html#pypol.roots.householder">[docs]</a><span class="k">def</span> <span class="nf">householder</span><span class="p">(</span><span class="n">poly</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">epsilon</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="s">&#39;-inf&#39;</span><span class="p">)):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Finds one root of the polynomial *poly* using the Householder&#39;s method, with this iteration formula:</span>
<span class="sd">        :math:`x_{n + 1} = x_n - \\frac{f(x_n)}{f&#39;(x_n)} \\Big\{ 1 + \\frac{f(x_n)f&#39;&#39;(x_n)}{2[f&#39;(x_n)]^2} \\Big\}`</span>

<span class="sd">    :param start: the start value to evaluate ``poly(x)``</span>
<span class="sd">    :param epsilon: the precision, default to ``float(&#39;-inf&#39;)``</span>
<span class="sd">    :type start: integer, float or complex</span>
<span class="sd">    :type epsilon: integer or float</span>
<span class="sd">    :rtype: integer or float</span>

<span class="sd">    **Examples**</span>

<span class="sd">    Let&#39;s find the roots of the polynomial ``x^4 + x^3 - 5x^2 + 3x``::</span>

<span class="sd">        &gt;&gt;&gt; p = (x + 3) * (x - 1) ** 2 * x</span>
<span class="sd">        &gt;&gt;&gt; p</span>
<span class="sd">        + x^4 + x^3 - 5x^2 + 3x</span>
<span class="sd">        &gt;&gt;&gt; householder(p, 100)</span>
<span class="sd">        1.0000000139750058</span>
<span class="sd">        &gt;&gt;&gt; householder(p, 2)</span>
<span class="sd">        1.0000000140746257</span>
<span class="sd">        &gt;&gt;&gt; r = householder(p, 2)</span>
<span class="sd">        &gt;&gt;&gt; p(r)</span>
<span class="sd">        0.0</span>
<span class="sd">        &gt;&gt;&gt; householder(p, -100)</span>
<span class="sd">        -3.0</span>
<span class="sd">        &gt;&gt;&gt; r = householder(p, -100)</span>
<span class="sd">        &gt;&gt;&gt; p(r)</span>
<span class="sd">        0.0</span>

<span class="sd">    if the precision is lower, the result will be worse::</span>

<span class="sd">        &gt;&gt;&gt; householder(p, 100, 0.1)</span>
<span class="sd">        1.0623451865071678</span>
<span class="sd">        &gt;&gt;&gt; householder(p, 100, 0.00001)</span>
<span class="sd">        1.0000036436860307</span>
<span class="sd">        &gt;&gt;&gt; householder(p, 100, 0.00000001)</span>
<span class="sd">        1.0000000049370159</span>
<span class="sd">        &gt;&gt;&gt; householder(p, -100, 0.1)</span>
<span class="sd">        -3.0000022501789867</span>
<span class="sd">        &gt;&gt;&gt; householder(p, -100, 0.001)</span>
<span class="sd">        -3.0</span>

<span class="sd">    **References**</span>

<span class="sd">    `Wikipedia &lt;http://en.wikipedia.org/wiki/Householder&#39;s_method&gt;`_ |</span>
<span class="sd">    `MathWorld &lt;http://mathworld.wolfram.com/HouseholdersMethod.html&gt;`_</span>

<span class="sd">    .. versionadded:: 0.4</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="n">p_d</span><span class="p">,</span> <span class="n">p_d_</span> <span class="o">=</span> <span class="n">polyder</span><span class="p">(</span><span class="n">poly</span><span class="p">),</span> <span class="n">polyder</span><span class="p">(</span><span class="n">poly</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
        <span class="n">x_n</span> <span class="o">=</span> <span class="n">start</span> <span class="o">-</span> <span class="p">(</span><span class="n">poly</span><span class="p">(</span><span class="n">start</span><span class="p">)</span><span class="o">/</span><span class="n">p_d</span><span class="p">(</span><span class="n">start</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="p">(</span><span class="n">poly</span><span class="p">(</span><span class="n">start</span><span class="p">)</span> <span class="o">*</span> <span class="n">p_d_</span><span class="p">(</span><span class="n">start</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">p_d</span><span class="p">(</span><span class="n">start</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">x_n</span> <span class="o">==</span> <span class="n">start</span> <span class="ow">or</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x_n</span> <span class="o">-</span> <span class="n">start</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">epsilon</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">x_n</span>
        <span class="n">start</span> <span class="o">=</span> <span class="n">x_n</span>
</div>
<div class="viewcode-block" id="schroeder"><a class="viewcode-back" href="../../roots.html#pypol.roots.schroeder">[docs]</a><span class="k">def</span> <span class="nf">schroeder</span><span class="p">(</span><span class="n">poly</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">epsilon</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="s">&#39;-inf&#39;</span><span class="p">)):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Finds one root of the polynomial *poly* using the Schröder&#39;s method, with the iteration formula:</span>
<span class="sd">        :math:`x_{n + 1} = x_n - \\frac{f(x_n)f&#39;(x_n)}{[f&#39;(x_n)]^2 - f(x_n)f&#39;&#39;(x_n)}`</span>

<span class="sd">    :param start: the start value to evaluate ``poly(x)``</span>
<span class="sd">    :param epsilon: the precision, default to ``float(&#39;-inf&#39;)``</span>
<span class="sd">    :type start: integer, float or complex</span>
<span class="sd">    :type epsilon: integer or float</span>
<span class="sd">    :rtype: integer or float</span>

<span class="sd">    **Examples**</span>

<span class="sd">    ::</span>

<span class="sd">        &gt;&gt;&gt; k = poly1d([3, -4, -1, 4])</span>
<span class="sd">        &gt;&gt;&gt; k</span>
<span class="sd">        + 3x^3 - 4x^2 - x + 4</span>
<span class="sd">        &gt;&gt;&gt; schroeder(k, 100)</span>
<span class="sd">        -0.859475828371609</span>
<span class="sd">        &gt;&gt;&gt; k(schroeder(k, 100))</span>
<span class="sd">        0.0</span>
<span class="sd">        &gt;&gt;&gt; schroeder(k, 100j)</span>
<span class="sd">        (1.0964045808524712-0.5909569632973221j)</span>
<span class="sd">        &gt;&gt;&gt; k(schroeder(k, 100))</span>
<span class="sd">        -1.1102230246251565e-16j</span>
<span class="sd">        &gt;&gt;&gt; schroeder(k, -100j)</span>
<span class="sd">        (1.0964045808524712+0.5909569632973221j)</span>
<span class="sd">        &gt;&gt;&gt; k(schroeder(k, 100))</span>
<span class="sd">        1.1102230246251565e-16j</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="n">p_d</span><span class="p">,</span> <span class="n">p_d_</span> <span class="o">=</span> <span class="n">polyder</span><span class="p">(</span><span class="n">poly</span><span class="p">),</span> <span class="n">polyder</span><span class="p">(</span><span class="n">poly</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
        <span class="n">ps</span><span class="p">,</span> <span class="n">pd</span> <span class="o">=</span> <span class="n">poly</span><span class="p">(</span><span class="n">start</span><span class="p">),</span> <span class="n">p_d</span><span class="p">(</span><span class="n">start</span><span class="p">)</span>
        <span class="n">x_n</span> <span class="o">=</span> <span class="n">start</span> <span class="o">-</span> <span class="p">(</span><span class="n">ps</span> <span class="o">*</span> <span class="n">pd</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">pd</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">ps</span> <span class="o">*</span> <span class="n">p_d_</span><span class="p">(</span><span class="n">start</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">x_n</span> <span class="o">==</span> <span class="n">start</span> <span class="ow">or</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x_n</span> <span class="o">-</span> <span class="n">start</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">epsilon</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">x_n</span>
        <span class="n">start</span> <span class="o">=</span> <span class="n">x_n</span>
</div>
<div class="viewcode-block" id="laguerre"><a class="viewcode-back" href="../../roots.html#pypol.roots.laguerre">[docs]</a><span class="k">def</span> <span class="nf">laguerre</span><span class="p">(</span><span class="n">poly</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">epsilon</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="s">&#39;-inf&#39;</span><span class="p">)):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Finds one root of the polynomial *poly* using the Laguerre&#39;s method, with the iteration formula:</span>
<span class="sd">        :math:`x_{k + 1} = x_k - \\frac{n}{max[G \pm \sqrt{(n - 1)(nH - G^2)}]}`</span>

<span class="sd">    where:</span>

<span class="sd">    :math:`G = \\frac{p&#39;(x_k)}{p(x_k)}`</span>

<span class="sd">    :math:`H = G^2 - \\frac{p&#39;&#39;(x_k)}{p(x_k)}`</span>

<span class="sd">    :param start: the start value to evaluate ``poly(x)``</span>
<span class="sd">    :param epsilon: the precision, default to ``float(&#39;-inf&#39;)``</span>
<span class="sd">    :type start: integer, float or complex</span>
<span class="sd">    :type epsilon: integer or float</span>
<span class="sd">    :rtype: complex</span>

<span class="sd">    **Examples**</span>

<span class="sd">    ::</span>

<span class="sd">        &gt;&gt;&gt; k = poly1d([32, -123, 43, 2])</span>
<span class="sd">        &gt;&gt;&gt; k</span>
<span class="sd">        + 32x^3 - 123x^2 + 43x + 2</span>
<span class="sd">        &gt;&gt;&gt; laguerre(k, 100)</span>
<span class="sd">        (3.448875873899064+0j)</span>
<span class="sd">        &gt;&gt;&gt; k(laguerre(k, 100))</span>
<span class="sd">        (2.5579538487363607e-13+0j)</span>
<span class="sd">        &gt;&gt;&gt; laguerre(k, 1)</span>
<span class="sd">        (0.43639990661090833+0j)</span>
<span class="sd">        &gt;&gt;&gt; k(laguerre(k, 1))</span>
<span class="sd">        0j</span>
<span class="sd">        &gt;&gt;&gt; laguerre(k, -100)</span>
<span class="sd">        (-0.041525780509971674+0j)</span>
<span class="sd">        &gt;&gt;&gt; k(laguerre(k, -100))</span>
<span class="sd">        0j</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="n">p_d</span><span class="p">,</span> <span class="n">p_d_</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="n">polyder</span><span class="p">(</span><span class="n">poly</span><span class="p">),</span> <span class="n">polyder</span><span class="p">(</span><span class="n">poly</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">poly</span><span class="o">.</span><span class="n">degree</span>
    <span class="n">start</span> <span class="o">=</span> <span class="nb">complex</span><span class="p">(</span><span class="n">start</span><span class="p">)</span>
    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
        <span class="n">px</span> <span class="o">=</span> <span class="n">poly</span><span class="p">(</span><span class="n">start</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">px</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">start</span>
        <span class="n">g</span> <span class="o">=</span> <span class="n">p_d</span><span class="p">(</span><span class="n">start</span><span class="p">)</span> <span class="o">/</span> <span class="n">px</span>
        <span class="n">h</span> <span class="o">=</span> <span class="n">g</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">p_d_</span><span class="p">(</span><span class="n">start</span><span class="p">)</span> <span class="o">/</span> <span class="n">px</span>
        <span class="n">dp</span> <span class="o">=</span> <span class="n">cmath</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">n</span> <span class="o">*</span> <span class="n">h</span> <span class="o">-</span> <span class="n">g</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
        <span class="n">d1</span> <span class="o">=</span> <span class="n">g</span> <span class="o">+</span> <span class="n">dp</span>
        <span class="n">d2</span> <span class="o">=</span> <span class="n">g</span> <span class="o">-</span> <span class="n">dp</span>
        <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">d2</span><span class="p">)</span> <span class="o">&gt;</span> <span class="nb">abs</span><span class="p">(</span><span class="n">d1</span><span class="p">):</span>
            <span class="n">d</span> <span class="o">=</span> <span class="n">d2</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">d</span> <span class="o">=</span> <span class="n">d1</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">n</span> <span class="o">/</span> <span class="n">d</span>
        <span class="n">x_n</span> <span class="o">=</span> <span class="n">start</span> <span class="o">-</span> <span class="n">a</span>
        <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">start</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span><span class="p">(</span><span class="n">x_n</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">abs</span><span class="p">(</span><span class="n">start</span> <span class="o">-</span> <span class="n">x_n</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">epsilon</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">start</span>
        <span class="n">start</span> <span class="o">=</span> <span class="n">x_n</span>
</div>
<span class="k">def</span> <span class="nf">muller</span><span class="p">(</span><span class="n">poly</span><span class="p">,</span> <span class="n">x_k</span><span class="p">,</span> <span class="n">x_k2</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">x_k3</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">epsilon</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="s">&#39;-inf&#39;</span><span class="p">)):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">x_k2</span><span class="p">:</span>
        <span class="n">x_k2</span> <span class="o">=</span> <span class="n">x_k</span> <span class="o">+</span> <span class="o">.</span><span class="mi">25</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">x_k3</span><span class="p">:</span>
        <span class="n">x_k3</span> <span class="o">=</span> <span class="n">x_k2</span> <span class="o">+</span> <span class="o">.</span><span class="mi">25</span>

    <span class="n">x</span> <span class="o">=</span> <span class="n">monomial</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
        <span class="n">w</span> <span class="o">=</span> <span class="n">divided_diff</span><span class="p">(</span><span class="n">poly</span><span class="p">,</span> <span class="p">[</span><span class="n">x_k</span><span class="p">,</span> <span class="n">x_k2</span><span class="p">])</span> <span class="o">+</span> <span class="n">divided_diff</span><span class="p">(</span><span class="n">poly</span><span class="p">,</span> <span class="p">[</span><span class="n">x_k</span><span class="p">,</span> <span class="n">x_k3</span><span class="p">])</span> <span class="o">-</span> <span class="n">divided_diff</span><span class="p">(</span><span class="n">poly</span><span class="p">,</span> <span class="p">[</span><span class="n">x_k2</span><span class="p">,</span> <span class="n">x_k3</span><span class="p">])</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">poly</span><span class="p">(</span><span class="n">x_k</span><span class="p">)</span> <span class="o">-</span> <span class="n">w</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">x_k</span><span class="p">)</span> <span class="o">+</span> <span class="n">divided_diff</span><span class="p">(</span><span class="n">poly</span><span class="p">,</span> <span class="p">[</span><span class="n">x_k</span><span class="p">,</span> <span class="n">x_k2</span><span class="p">,</span> <span class="n">x_k3</span><span class="p">])</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">x_k</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>
        <span class="n">n</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">poly</span><span class="p">(</span><span class="n">x_k</span><span class="p">)</span>
        <span class="n">k</span> <span class="o">=</span> <span class="n">w</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">-</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">poly</span><span class="p">(</span><span class="n">x_k</span><span class="p">)</span> <span class="o">*</span> <span class="n">divided_diff</span><span class="p">(</span><span class="n">poly</span><span class="p">,</span> <span class="p">[</span><span class="n">x_k</span><span class="p">,</span> <span class="n">x_k2</span><span class="p">,</span> <span class="n">x_k3</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">d_part</span> <span class="o">=</span> <span class="o">-</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="o">-</span><span class="n">k</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">d_part</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
        <span class="n">d</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">w</span> <span class="o">+</span> <span class="n">d_part</span><span class="p">,</span> <span class="n">w</span> <span class="o">-</span> <span class="n">d_part</span><span class="p">)</span>
        <span class="n">x_k1</span> <span class="o">=</span> <span class="n">x_k</span> <span class="o">-</span> <span class="n">n</span> <span class="o">/</span> <span class="n">d</span>
        <span class="k">if</span> <span class="n">x_k1</span> <span class="o">==</span> <span class="n">x_k</span> <span class="ow">or</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x_k1</span> <span class="o">-</span> <span class="n">x_k</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">epsilon</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">x_k1</span>
        <span class="n">x_k</span> <span class="o">=</span> <span class="n">x_k1</span>

<div class="viewcode-block" id="durand_kerner"><a class="viewcode-back" href="../../roots.html#pypol.roots.durand_kerner">[docs]</a><span class="k">def</span> <span class="nf">durand_kerner</span><span class="p">(</span><span class="n">poly</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="nb">complex</span><span class="p">(</span><span class="o">.</span><span class="mi">4</span><span class="p">,</span> <span class="o">.</span><span class="mi">9</span><span class="p">),</span> <span class="n">epsilon</span><span class="o">=</span><span class="mf">1.12e-16</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    The Durand-Kerner method. It finds all the roots of the polynomials *poly* simultaneously.</span>
<span class="sd">    With some polynomials it works quite well::</span>

<span class="sd">        &gt;&gt;&gt; from pypol.funcs import from_roots</span>
<span class="sd">        &gt;&gt;&gt; p = from_roots([1, -3, 14, 5, -100])</span>
<span class="sd">        &gt;&gt;&gt; p</span>
<span class="sd">        + x^5 + 83x^4 - 1671x^3 + 3097x^2 + 19490x - 21000</span>
<span class="sd">        &gt;&gt;&gt; durand_kerner(p)</span>
<span class="sd">        ((1+0j), (5+0j), (-100+0j), (-3+0j), (13.999999999999998+0j))</span>
<span class="sd">        &gt;&gt;&gt; map(p, durand_kerner(p))</span>
<span class="sd">        [0j, 0j, 0j, 0j, (-7.5669959187507629e-10+0j)]</span>
<span class="sd">        &gt;&gt;&gt; p = from_roots([1, -3, 14, 5, -10, 4242])</span>
<span class="sd">        &gt;&gt;&gt; p</span>
<span class="sd">        + x^6 - 4249x^5 + 29553x^4 + 598609x^3 - 2064094x^2 - 7468020x + 8908200</span>
<span class="sd">        &gt;&gt;&gt; durand_kerner(p)</span>
<span class="sd">        ((1+0j), (-3+0j), (-10+0j), (5+0j), (4242-1.2727475858741762e-49j), (14+0j))</span>
<span class="sd">        &gt;&gt;&gt; map(p, durand_kerner(p))</span>
<span class="sd">        [0j, 0j, 0j, 0j, (60112-1.7453195261352414e-31j), 0j]</span>
<span class="sd">        &gt;&gt;&gt; p = poly1d([1, 2, -3, 1, -4])</span>
<span class="sd">        &gt;&gt;&gt; durand_kerner(p)</span>
<span class="sd">        ((1.3407787867177585-9.656744866722633e-34j), (-0.084897978584602823-0.96623889223617843j), (-3.1709828295485529+8.2085042293591779e-34j), (-0.084897978584602823+0.96623889223617843j))</span>
<span class="sd">        &gt;&gt;&gt; map(p, durand_kerner(p))</span>
<span class="sd">        [(-8.8817841970012523e-16-1.2923293554560813e-32j), (-4.4408920985006262e-16-2.2204460492503131e-16j), (3.5527136788005009e-15-3.8729295219100667e-32j), (-4.4408920985006262e-16+2.2204460492503131e-16j)]</span>
<span class="sd">        &gt;&gt;&gt; durand_kerner(p)</span>
<span class="sd">        ((1+0j), (-2424+6.2230152778611417e-61j), (14+1.2446030555722283e-60j), (381.99999999999994+4.6672614583958563e-61j), (133-7.0008921875937844e-61j), (5-2.4892061111444567e-60j), (-100+3.3735033418337674e-80j), (-3+4.9784122222889134e-60j))</span>
<span class="sd">        &gt;&gt;&gt; map(p, durand_kerner(p))</span>
<span class="sd">        [0j, (116436291584-3.6076395061767809e-37j), 3.0129989385594897e-47j, (-110296.125+3.1986819282098692e-42j), (212+2.8399399457319209e-44j), 8.8231056584250621e-48j, 1.032541429306196e-63j, -3.3300895740082056e-47j]</span>

<span class="sd">    But with other polynomials it could raise an :exc:`OverflowError`::</span>

<span class="sd">        &gt;&gt;&gt; p = poly1d([-1, 2, -3, 1, 4])</span>
<span class="sd">        &gt;&gt;&gt; p</span>
<span class="sd">        - x^4 + 2x^3 - 3x^2 + x + 4</span>
<span class="sd">        &gt;&gt;&gt; durand_kerner(p)</span>
<span class="sd">        Traceback (most recent call last):</span>
<span class="sd">          File &quot;&lt;pyshell#20&gt;&quot;, line 1, in &lt;module&gt;</span>
<span class="sd">            durand_kerner(p)</span>
<span class="sd">          File &quot;roots.py&quot;, line 641, in durand_kerner</span>
<span class="sd">            &gt;&gt;&gt; map(p, durand_kerner(p))</span>
<span class="sd">          File &quot;core.py&quot;, line 1429, in __call__</span>
<span class="sd">            return eval(self.eval_form, letters)</span>
<span class="sd">          File &quot;&lt;string&gt;&quot;, line 1, in &lt;module&gt;</span>
<span class="sd">        OverflowError: complex exponentiation</span>

<span class="sd">    In this cases you can use other root-finding algorithms, like :func:`laguerre` or :func:`halley`::</span>

<span class="sd">        &gt;&gt;&gt; laguerre(p, 10)</span>
<span class="sd">        (5.0000000000018261+0j)</span>
<span class="sd">        &gt;&gt;&gt; laguerre(p, 5)</span>
<span class="sd">        (5+0j)</span>
<span class="sd">        &gt;&gt;&gt; p((5+0j))</span>
<span class="sd">        0j</span>
<span class="sd">        &gt;&gt;&gt; halley(p, 10)</span>
<span class="sd">        5.0</span>
<span class="sd">        &gt;&gt;&gt; halley(p, 100)</span>
<span class="sd">        14.0</span>
<span class="sd">        &gt;&gt;&gt; halley(p, 1000)</span>
<span class="sd">        382.0</span>
<span class="sd">        &gt;&gt;&gt; halley(p, -1000)</span>
<span class="sd">        -100.0</span>
<span class="sd">        &gt;&gt;&gt; halley(p, -100)</span>
<span class="sd">        -100.0</span>
<span class="sd">        &gt;&gt;&gt; halley(p, -10)</span>
<span class="sd">        -3.0</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="n">roots</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">poly</span><span class="o">.</span><span class="n">degree</span><span class="p">):</span>
        <span class="n">roots</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">start</span> <span class="o">**</span> <span class="n">e</span><span class="p">)</span>
    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
        <span class="n">new</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">roots</span><span class="p">):</span>
            <span class="n">new_r</span> <span class="o">=</span> <span class="n">r</span> <span class="o">-</span> <span class="p">(</span><span class="n">poly</span><span class="p">(</span><span class="n">r</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="nb">reduce</span><span class="p">(</span><span class="n">operator</span><span class="o">.</span><span class="n">mul</span><span class="p">,</span> <span class="p">[(</span><span class="n">r</span> <span class="o">-</span> <span class="n">r_1</span><span class="p">)</span> <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">r_1</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">roots</span><span class="p">)</span> <span class="k">if</span> <span class="n">i</span> <span class="o">!=</span> <span class="n">j</span><span class="p">]))</span>
            <span class="n">new</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_r</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span><span class="p">(</span><span class="n">roots</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">or</span> <span class="nb">abs</span><span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="n">roots</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">&lt;</span> <span class="n">epsilon</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">new</span><span class="p">)):</span>
            <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">new</span><span class="p">)</span>
        <span class="n">roots</span> <span class="o">=</span> <span class="n">new</span>
</div>
<div class="viewcode-block" id="brent"><a class="viewcode-back" href="../../roots.html#pypol.roots.brent">[docs]</a><span class="k">def</span> <span class="nf">brent</span><span class="p">(</span><span class="n">poly</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">epsilon</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="s">&#39;-inf&#39;</span><span class="p">)):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Finds a root of the polynomial *poly*, with the Brent&#39;s method.</span>

<span class="sd">    :param a,b: The limits of the interval, where the root is searched</span>
<span class="sd">    :param epsilon: The precision, default to float(&#39;-inf&#39;)</span>
<span class="sd">    :rtype: integer or float</span>

<span class="sd">    **Examples**</span>

<span class="sd">        &gt;&gt;&gt; p = poly1d([1, -4, 3, -4])</span>
<span class="sd">        &gt;&gt;&gt; p</span>
<span class="sd">        + x^3 - 4x^2 + 3x - 4</span>
<span class="sd">        &gt;&gt;&gt; brent(p, 100, -100)</span>
<span class="sd">        3.4675038570565078</span>
<span class="sd">        &gt;&gt;&gt; r = brent(p, 100, -100)</span>
<span class="sd">        &gt;&gt;&gt; p(r)</span>
<span class="sd">        -1.1723955140041653e-13</span>

<span class="sd">    If we start closer::</span>

<span class="sd">        &gt;&gt;&gt; r = brent(p, 10, -10)</span>
<span class="sd">        &gt;&gt;&gt; p(r)</span>
<span class="sd">        -1.7763568394002505e-15</span>

<span class="sd">    the precision is greater.</span>

<span class="sd">    **References**</span>

<span class="sd">    Pseudocode from `Wikipedia &lt;http://en.wikipedia.org/wiki/Brent&#39;s_method#Algorithm&gt;`_</span>

<span class="sd">    .. warning:: Doesn&#39;t seem to work in some cases.</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="n">pa</span><span class="p">,</span> <span class="n">pb</span> <span class="o">=</span> <span class="n">poly</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="n">poly</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">pa</span> <span class="o">*</span> <span class="n">pb</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&#39;poly(a) and poly(b) must have opposite sign&#39;</span>
    <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">pa</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">abs</span><span class="p">(</span><span class="n">pb</span><span class="p">):</span>
        <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">b</span><span class="p">,</span> <span class="n">a</span>

    <span class="n">c</span> <span class="o">=</span> <span class="n">a</span>
    <span class="n">flag</span> <span class="o">=</span> <span class="bp">True</span>
    <span class="n">d</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
        <span class="n">pa</span><span class="p">,</span> <span class="n">pb</span><span class="p">,</span> <span class="n">pc</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="n">poly</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="n">poly</span><span class="p">(</span><span class="n">b</span><span class="p">),</span> <span class="n">poly</span><span class="p">(</span><span class="n">c</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">pb</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="nb">abs</span><span class="p">(</span><span class="n">b</span> <span class="o">-</span> <span class="n">a</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">epsilon</span><span class="p">:</span>
            <span class="k">break</span>

        <span class="k">if</span> <span class="n">pa</span> <span class="o">!=</span> <span class="n">pc</span> <span class="ow">and</span> <span class="n">pb</span> <span class="o">!=</span> <span class="n">pc</span><span class="p">:</span>
            <span class="n">s1</span> <span class="o">=</span> <span class="p">((</span><span class="n">a</span> <span class="o">*</span> <span class="n">pb</span> <span class="o">*</span> <span class="n">pc</span><span class="p">)</span> <span class="o">/</span> <span class="p">((</span><span class="n">pa</span> <span class="o">-</span> <span class="n">pb</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">pa</span> <span class="o">-</span> <span class="n">pc</span><span class="p">)))</span>
            <span class="n">s2</span> <span class="o">=</span> <span class="p">((</span><span class="n">b</span> <span class="o">*</span> <span class="n">pa</span> <span class="o">*</span> <span class="n">pc</span><span class="p">)</span> <span class="o">/</span> <span class="p">((</span><span class="n">pb</span> <span class="o">-</span> <span class="n">pa</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">pb</span> <span class="o">-</span> <span class="n">pc</span><span class="p">)))</span>
            <span class="n">s3</span> <span class="o">=</span> <span class="p">((</span><span class="n">c</span> <span class="o">*</span> <span class="n">pa</span> <span class="o">*</span> <span class="n">pb</span><span class="p">)</span> <span class="o">/</span> <span class="p">((</span><span class="n">pc</span> <span class="o">-</span> <span class="n">pa</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">pc</span> <span class="o">-</span> <span class="n">pb</span><span class="p">)))</span>
            <span class="n">s</span> <span class="o">=</span>  <span class="n">s1</span> <span class="o">+</span> <span class="n">s2</span> <span class="o">+</span> <span class="n">s3</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">s</span> <span class="o">=</span> <span class="n">b</span> <span class="o">-</span> <span class="n">pb</span> <span class="o">*</span> <span class="p">((</span><span class="n">b</span> <span class="o">-</span> <span class="n">a</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">pb</span> <span class="o">-</span> <span class="n">pa</span><span class="p">))</span>

        <span class="k">if</span> <span class="mi">0</span> <span class="ow">in</span> <span class="p">(</span><span class="n">pb</span><span class="p">,</span> <span class="n">poly</span><span class="p">(</span><span class="n">s</span><span class="p">))</span> <span class="ow">or</span> <span class="nb">abs</span><span class="p">(</span><span class="n">b</span> <span class="o">-</span> <span class="n">a</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">epsilon</span><span class="p">:</span>
            <span class="k">break</span>

        <span class="n">_1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="p">)</span> <span class="o">/</span> <span class="mi">4</span>
        <span class="n">c_1_</span> <span class="o">=</span> <span class="n">s</span> <span class="o">&gt;=</span> <span class="n">b</span> <span class="ow">and</span> <span class="n">s</span> <span class="o">&lt;=</span> <span class="n">_1</span>
        <span class="n">c_1_1</span> <span class="o">=</span> <span class="n">s</span> <span class="o">&gt;=</span> <span class="n">_1</span> <span class="ow">and</span> <span class="n">s</span> <span class="o">&lt;=</span> <span class="n">b</span>

        <span class="n">c_1</span> <span class="o">=</span> <span class="n">c_1_</span> <span class="ow">or</span> <span class="n">c_1_1</span>
        <span class="n">c_2</span> <span class="o">=</span> <span class="n">flag</span> <span class="ow">and</span> <span class="nb">abs</span><span class="p">(</span><span class="n">s</span> <span class="o">-</span> <span class="n">b</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">b</span> <span class="o">-</span> <span class="n">c</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="n">c_3</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">flag</span> <span class="ow">and</span> <span class="nb">abs</span><span class="p">(</span><span class="n">s</span> <span class="o">-</span> <span class="n">b</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="p">(</span><span class="n">c</span> <span class="o">-</span> <span class="n">d</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>

        <span class="k">if</span> <span class="n">c_1</span> <span class="ow">or</span> <span class="n">c_2</span> <span class="ow">or</span> <span class="n">c_3</span><span class="p">:</span>
            <span class="n">s</span> <span class="o">=</span> <span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
            <span class="n">flag</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">flag</span> <span class="o">=</span> <span class="bp">False</span>

        <span class="n">d</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">c</span><span class="p">,</span> <span class="n">b</span>
        <span class="n">ps</span> <span class="o">=</span> <span class="n">poly</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">pa</span> <span class="o">*</span> <span class="n">ps</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">b</span> <span class="o">=</span> <span class="n">s</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">a</span> <span class="o">=</span> <span class="n">s</span>

        <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">pa</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">abs</span><span class="p">(</span><span class="n">pb</span><span class="p">):</span>
            <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">b</span><span class="p">,</span> <span class="n">a</span>

    <span class="k">return</span> <span class="n">b</span>
</div>
<div class="viewcode-block" id="bisection"><a class="viewcode-back" href="../../roots.html#pypol.roots.bisection">[docs]</a><span class="k">def</span> <span class="nf">bisection</span><span class="p">(</span><span class="n">poly</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">epsilon</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="s">&#39;-inf&#39;</span><span class="p">)):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Finds the root of the polynomial *poly* using the *bisection method*.</span>
<span class="sd">    When it finds the root, it checks if ``-root`` is one root too. If so, it returns a two-length tuple, else a tuple</span>
<span class="sd">    with one root.</span>

<span class="sd">    :param float k: the increment of the two extreme point. The increment is calculated with the formula ``a + ak``.</span>

<span class="sd">    So, if *a* is 50, after the increment ``50 + 50*0.5`` *a* will be 75.</span>
<span class="sd">    *epsilon* sets the precision of the calculation. Smaller it is, greater is the precision.</span>

<span class="sd">    :raises: :exc:`ValueError` if *epsilon* is bigger than 5 or *k* is negative</span>
<span class="sd">    :rtype: integer or float or NotImplemented when:</span>

<span class="sd">            * *poly* has more than one letter</span>
<span class="sd">            * or the root is a complex number</span>

<span class="sd">    **References**</span>

<span class="sd">    `Wikipedia &lt;http://en.wikipedia.org/wiki/Bisection_method&gt;`_</span>

<span class="sd">    .. warning::</span>
<span class="sd">        In some case this function may not work!</span>

<span class="sd">    .. versionadded:: 0.2</span>
<span class="sd">    .. versionchanged:: 0.3</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Warning</span><span class="p">(</span><span class="s">&#39;May not work with k = 0&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;k value cannot be negative&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">epsilon</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;epsilon cannot be greater than 5&#39;</span><span class="p">)</span>

    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">poly</span><span class="o">.</span><span class="n">letters</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>

    <span class="k">assert</span>  <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="n">coeff</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">coeff</span> <span class="ow">in</span> <span class="n">poly</span><span class="o">.</span><span class="n">coefficients</span><span class="p">)</span> <span class="ow">and</span> \
            <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="n">exp</span> <span class="o">&amp;</span> <span class="mi">1</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">exp</span> <span class="ow">in</span> <span class="n">poly</span><span class="o">.</span><span class="n">powers</span><span class="p">(</span><span class="n">poly</span><span class="o">.</span><span class="n">letters</span><span class="p">[</span><span class="mi">0</span><span class="p">])),</span> \
            <span class="s">&#39;The root of the polynomial is a complex number&#39;</span>

    <span class="n">_d</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="n">a</span> <span class="o">*</span> <span class="n">b</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="c"># Check if discordant</span>
    <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">media</span> <span class="o">=</span> <span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="mi">89</span><span class="p">,</span> <span class="mi">0</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
            <span class="n">nmedia</span> <span class="o">=</span> <span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span> <span class="c"># Midpoint</span>
            <span class="k">if</span> <span class="n">_d</span><span class="p">(</span><span class="n">poly</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="n">poly</span><span class="p">(</span><span class="n">nmedia</span><span class="p">)):</span>
                <span class="n">b</span> <span class="o">=</span> <span class="n">nmedia</span>
            <span class="k">elif</span> <span class="n">_d</span><span class="p">(</span><span class="n">poly</span><span class="p">(</span><span class="n">b</span><span class="p">),</span> <span class="n">poly</span><span class="p">(</span><span class="n">nmedia</span><span class="p">)):</span>
                <span class="n">a</span> <span class="o">=</span> <span class="n">nmedia</span>
            <span class="k">else</span><span class="p">:</span> <span class="c"># Not discordant</span>
                <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="n">a</span><span class="o">*</span><span class="n">k</span><span class="p">,</span> <span class="n">b</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="n">k</span>
            <span class="k">if</span> <span class="n">media</span> <span class="o">==</span> <span class="n">nmedia</span> <span class="ow">or</span> <span class="nb">abs</span><span class="p">(</span><span class="n">a</span> <span class="o">-</span> <span class="n">b</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">epsilon</span><span class="p">:</span>
                <span class="k">break</span>
            <span class="n">media</span> <span class="o">=</span> <span class="n">nmedia</span>
    <span class="k">except</span> <span class="ne">OverflowError</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">NotImplemented</span>

    <span class="k">return</span> <span class="n">media</span>

<span class="c">################################################################################</span>
<span class="c">##                            Still in development                            ##</span>
<span class="c">################################################################################</span>

</div>
<span class="k">def</span> <span class="nf">ridder</span><span class="p">(</span><span class="n">poly</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">epsilon</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="s">&#39;-inf&#39;</span><span class="p">)):</span>
    <span class="k">def</span> <span class="nf">closest</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>
        <span class="n">a1</span> <span class="o">=</span> <span class="p">[</span><span class="nb">abs</span><span class="p">(</span><span class="n">x0</span> <span class="o">-</span> <span class="n">k</span><span class="p">),</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x1</span> <span class="o">-</span> <span class="n">k</span><span class="p">),</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x2</span> <span class="o">-</span> <span class="n">k</span><span class="p">)]</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">][</span><span class="n">a1</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">a1</span><span class="p">))]</span>

    <span class="k">assert</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x0</span> <span class="o">-</span> <span class="n">x1</span><span class="p">)</span> <span class="o">==</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x1</span> <span class="o">-</span> <span class="n">x2</span><span class="p">),</span> <span class="s">&#39;The three points x0, x1 and x2 must be equally distanced&#39;</span>

    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
        <span class="n">d0</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x0</span> <span class="o">-</span> <span class="n">x1</span><span class="p">)</span>
        <span class="n">y0</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">poly</span><span class="p">(</span><span class="n">x0</span><span class="p">),</span> <span class="n">poly</span><span class="p">(</span><span class="n">x1</span><span class="p">),</span> <span class="n">poly</span><span class="p">(</span><span class="n">x2</span><span class="p">)</span>
        <span class="n">a</span> <span class="o">=</span> <span class="p">(</span><span class="n">y0</span> <span class="o">-</span> <span class="n">y1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">y1</span> <span class="o">-</span> <span class="n">y2</span><span class="p">)</span>
        <span class="n">b</span> <span class="o">=</span> <span class="p">(</span><span class="n">y0</span> <span class="o">-</span> <span class="n">y1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">y0</span> <span class="o">-</span> <span class="n">a</span><span class="o">*</span><span class="n">y1</span><span class="p">)</span>
        <span class="n">u</span> <span class="o">=</span> <span class="p">(</span><span class="n">b</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">b</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">v</span> <span class="o">=</span> <span class="p">(</span><span class="n">a</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">x3</span> <span class="o">=</span> <span class="n">x1</span> <span class="o">-</span> <span class="n">d0</span> <span class="o">*</span> <span class="p">(</span><span class="n">u</span><span class="o">*</span><span class="p">(</span><span class="mi">3</span> <span class="o">+</span> <span class="n">u</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">v</span><span class="o">*</span><span class="p">(</span><span class="mi">3</span> <span class="o">+</span> <span class="n">v</span><span class="o">**</span><span class="mi">2</span><span class="p">)))</span>
        <span class="n">x0</span> <span class="o">=</span> <span class="n">closest</span><span class="p">(</span><span class="n">x3</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">x0</span> <span class="o">==</span> <span class="n">x3</span> <span class="ow">or</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x0</span> <span class="o">-</span> <span class="n">x3</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">epsilon</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">x3</span>
        <span class="n">x1</span> <span class="o">=</span> <span class="n">x3</span>
        <span class="n">x2</span> <span class="o">=</span> <span class="n">x1</span> <span class="o">+</span> <span class="p">(</span><span class="n">x1</span> <span class="o">-</span> <span class="n">x0</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">lambert</span><span class="p">(</span><span class="n">poly</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">epsilon</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="s">&#39;-inf&#39;</span><span class="p">)):</span>
    <span class="k">def</span> <span class="nf">_hg</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(((</span><span class="n">d</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">n</span> <span class="o">**</span> <span class="n">d</span> <span class="o">+</span> <span class="p">(</span><span class="n">d</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">r</span><span class="p">)</span> <span class="o">/</span> <span class="p">((</span><span class="n">d</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">n</span> <span class="o">**</span> <span class="n">d</span> <span class="o">+</span> <span class="p">(</span><span class="n">d</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">r</span><span class="p">))</span> <span class="o">*</span> <span class="n">n</span>

    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">poly</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">poly</span><span class="o">.</span><span class="n">right_hand_side</span><span class="p">,</span> <span class="s">&#39;poly must be on the form x^d - r&#39;</span>

    <span class="n">d</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="n">poly</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span> <span class="n">poly</span><span class="o">.</span><span class="n">right_hand_side</span>
    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
        <span class="n">x_n</span> <span class="o">=</span> <span class="n">start</span> <span class="o">-</span> <span class="n">_hg</span><span class="p">(</span><span class="n">start</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">x_n</span> <span class="o">==</span> <span class="n">start</span> <span class="ow">or</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x_n</span> <span class="o">-</span> <span class="n">start</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">epsilon</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">x_n</span>
        <span class="n">start</span> <span class="o">=</span> <span class="n">x_n</span>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" size="18" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../../index.html">pypol v0.4 documentation</a> &raquo;</li>
          <li><a href="../index.html" >Module code</a> &raquo;</li>
          <li><a href="../pypol.html" >pypol</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2010, Michele Lacchia.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.0.7.
    </div>
  </body>
</html>